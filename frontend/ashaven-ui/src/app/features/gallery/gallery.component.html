<div class="container mx-auto px-4">
  <!-- Header + Create button (unchanged) -->
  <div class="flex items-center mb-4">
    <h6 class="text-lg font-bold text-dark grow">List of Gallery</h6>
    <div class="shrink-0">
      <button
        type="button"
        class="px-5 py-2 text-white bg-accent border-accent hover:bg-accent-dark hover:border-accent-dark focus:ring-4 focus:ring-accent/20 font-medium rounded-lg text-sm"
        (click)="toggleCreateModal()"
      >
        <span class="align-middle">Create Gallery</span>
      </button>
    </div>
  </div>

  <!-- Controls: Page size + status -->
  <div class="mb-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
    <div class="flex items-center gap-2">
      <label class="text-sm text-gray-600">Rows per page:</label>
      <select
        class="border rounded-md px-2 py-1 text-sm bg-white dark:bg-gray-800 dark:text-gray-200"
        [ngModel]="pageSize"
        (ngModelChange)="onPageSizeChange($event)"
      >
        <option [ngValue]="5">5</option>
        <option [ngValue]="10">10</option>
        <option [ngValue]="20">20</option>
        <option [ngValue]="50">50</option>
      </select>
    </div>

    <div class="text-sm text-gray-600">
      Showing
      <span class="font-semibold">
        {{ (currentPage - 1) * pageSize + 1 }}
        â€“
        {{
          Math.min(currentPage * pageSize, totalItems)
        }}
      </span>
      of <span class="font-semibold">{{ totalItems }}</span>
    </div>
  </div>

  <!-- Table -->
  <div class="relative overflow-x-auto shadow-md">
    <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
      <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
        <tr>
          <th scope="col" class="px-6 py-3">Title</th>
          <th scope="col" class="px-6 py-3">Description</th>
          <th scope="col" class="px-6 py-3">Type</th>
          <th scope="col" class="px-6 py-3">Content</th>
          <th scope="col" class="px-6 py-3">Status</th>
          <th scope="col" class="px-6 py-3">Order</th>
          <th scope="col" class="px-6 py-3">
            <span class="sr-only">Action</span>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let item of pagedGallery"
          class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 border-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600"
        >
          <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">
            {{ item.title }}
          </th>
          <td class="px-6 py-4">{{ item.description }}</td>
          <td class="px-6 py-4">{{ item.contentType }}</td>
          <td class="px-6 py-4">
            <ng-container *ngIf="item.contentType === 'Image'">
              <img class="w-16 h-10 object-cover rounded" [src]="baseUrl + '/api/attachment/get/' + item.contentName" alt="">
            </ng-container>
            <ng-container *ngIf="item.contentType === 'Video'">
              <video class="w-16 h-10 rounded" preload="metadata">
                <source [src]="baseUrl + '/api/attachment/get/' + item.contentName" type="video/mp4" />
              </video>
            </ng-container>
          </td>
          <td class="px-6 py-4">
            <ng-container *ngIf="item.isActive; else inactive">
              <span class="px-2.5 py-0.5 text-xs font-medium rounded border bg-green-100 border-transparent text-green-600 dark:bg-green-500/20 dark:text-green-400 inline-flex items-center">
                <i class="ri-checkbox-line mr-1.5"></i> Active
              </span>
            </ng-container>
            <ng-template #inactive>
              <span class="px-2.5 py-0.5 text-xs font-medium rounded border bg-red-100 border-transparent text-red-600 dark:bg-red-500/20 dark:text-red-400 inline-flex items-center">
                <i class="ri-close-circle-line mr-1.5"></i> Inactive
              </span>
            </ng-template>
          </td>
          <td class="px-6 py-4">{{ item.order }}</td>
          <td class="px-6 py-4 text-right">
            <button
              (click)="openEditModal(item)"
              class="text-blue-700 hover:text-white border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-3 py-1 me-2 mb-2 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:hover:bg-blue-500 dark:focus:ring-blue-800"
            >Edit</button>

            <ng-container *ngIf="item.isActive; else activateBtn">
              <button
                (click)="itemActiveInactive(item.id, false)"
                class="text-red-700 hover:text-white border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-3 py-1 me-2 mb-2 dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900"
              >Deactivate</button>
            </ng-container>
            <ng-template #activateBtn>
              <button
                (click)="itemActiveInactive(item.id, true)"
                class="text-green-700 hover:text-white border border-green-700 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm px-3 py-1 me-2 mb-2 dark:border-green-500 dark:text-green-500 dark:hover:text-white dark:hover:bg-green-600 dark:focus:ring-green-800"
              >Activate</button>
            </ng-template>

            <button
              (click)="itemDelete(item.id)"
              class="text-red-700 hover:text-white border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-3 py-1 mb-2 dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900"
            >Delete</button>
          </td>
        </tr>

        <tr *ngIf="!totalItems" class="text-center">
          <td colspan="7" class="p-3">No items found.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="mt-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
    <div class="text-sm text-gray-600">
      Page <span class="font-semibold">{{ currentPage }}</span> of
      <span class="font-semibold">{{ pageCount }}</span>
    </div>

    <div class="inline-flex items-center gap-1">
      <button
        (click)="changePage(-1)"
        [disabled]="currentPage === 1"
        class="px-3 py-2 rounded-md border text-sm bg-accent "
      >
        Previous
      </button>

      <!-- Numbered pages -->
      <ng-container *ngFor="let p of pages">
        <button
          (click)="goToPage(p)"
          class="w-9 h-9 rounded-md border text-sm"
          [class.bg-accent]="p === currentPage"
          [class.text-white]="p === currentPage"
          [class.border-accent]="p === currentPage"
        >
          {{ p }}
        </button>
      </ng-container>

      <button
        (click)="changePage(1)"
        [disabled]="currentPage === pageCount"
        class="px-3 py-2 rounded-md border text-sm bg-accent "
      >
        Next
      </button>
    </div>
  </div>

  <!-- CREATE MODAL (NEW) -->
  <div *ngIf="showCreateModal" class="fixed inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full z-50" (click)="toggleCreateModal()">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white dark:bg-gray-800" (click)="$event.stopPropagation()">
      <div class="mt-3">
        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Create New Gallery</h3>
        <form (ngSubmit)="createData()" class="space-y-4">
          <div>
            <label for="title" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Title *</label>
            <input type="text" id="title" [(ngModel)]="newItem.title" name="title" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-accent focus:ring focus:ring-accent focus:ring-opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
          </div>
          <div>
            <label for="description" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Description</label>
            <textarea id="description" [(ngModel)]="newItem.description" name="description" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-accent focus:ring focus:ring-accent focus:ring-opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white"></textarea>
          </div>
          <div>
            <label for="contentType" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Content Type *</label>
            <select id="contentType" [(ngModel)]="newItem.contentType" name="contentType" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-accent focus:ring focus:ring-accent focus:ring-opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
              <option value="">Select Type</option>
              <option value="Image">Image</option>
              <option value="Video">Video</option>
            </select>
          </div>
          <div>
            <label for="file" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Content File</label>
            <input type="file" id="file" (change)="onFileChange($event)" accept="image/*,video/*" class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-accent file:text-white hover:file:bg-accent-dark">
          </div>
          <div>
            <label for="order" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Order</label>
            <input type="number" id="order" [(ngModel)]="newItem.order" name="order" min="0" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-accent focus:ring focus:ring-accent focus:ring-opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
          </div>
          <div class="flex justify-end space-x-2 pt-4">
            <button type="button" (click)="toggleCreateModal()" class="px-4 py-2 text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent">Cancel</button>
            <button type="submit" class="px-4 py-2 text-white bg-accent border border-accent rounded-md hover:bg-accent-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent">Create</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- EDIT MODAL (NEW - similar structure for completeness) -->
  <div *ngIf="showEditModal" class="fixed inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full z-50" (click)="toggleEditModal()">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white dark:bg-gray-800" (click)="$event.stopPropagation()">
      <div class="mt-3">
        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Edit Gallery</h3>
        <form (ngSubmit)="editData()" class="space-y-4">
          <div>
            <label for="editTitle" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Title *</label>
            <input type="text" id="editTitle" [(ngModel)]="editItem.title" name="title" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-accent focus:ring focus:ring-accent focus:ring-opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
          </div>
          <div>
            <label for="editDescription" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Description</label>
            <textarea id="editDescription" [(ngModel)]="editItem.description" name="description" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-accent focus:ring focus:ring-accent focus:ring-opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white"></textarea>
          </div>
          <div>
            <label for="editContentType" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Content Type *</label>
            <select id="editContentType" [(ngModel)]="editItem.contentType" name="contentType" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-accent focus:ring focus:ring-accent focus:ring-opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
              <option value="">Select Type</option>
              <option value="Image">Image</option>
              <option value="Video">Video</option>
            </select>
          </div>
          <div>
            <label for="editFile" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Update Content File</label>
            <input type="file" id="editFile" (change)="onEditFileChange($event)" accept="image/*,video/*" class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-accent file:text-white hover:file:bg-accent-dark">
          </div>
          <div>
            <label for="editOrder" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Order</label>
            <input type="number" id="editOrder" [(ngModel)]="editItem.order" name="order" min="0" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-accent focus:ring focus:ring-accent focus:ring-opacity-50 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
          </div>
          <div class="flex justify-end space-x-2 pt-4">
            <button type="button" (click)="toggleEditModal()" class="px-4 py-2 text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent">Cancel</button>
            <button type="submit" class="px-4 py-2 text-white bg-accent border border-accent rounded-md hover:bg-accent-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent">Update</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>